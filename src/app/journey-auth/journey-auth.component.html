<div class="Frame shadow border rounded border-secondary">
  <div class="row">
    <h3 class="h3 text-info">Journey Authentication</h3>

    <div style="margin: 0px auto">
      <div class="d-flex">
        <!-- <div class="selectAgent w-25">
          <h6 class="h6">Select an agent</h6>
          <select class="form-select" aria-label="Default select example">
            <option selected>Agent 1</option>
            <option value="1">Agent 2</option>
            <option value="2">Agent 3</option>
            <option value="3">Agent 4</option>
          </select>
        </div> -->

        <div class="EnterNumber w-50">
          <h6 class="h6">Enter a phone number</h6>
          <div class="d-flex">
            <input
              type="text"
              class="form-control"
              placeholder="Enter mobile number"
              #mno
            />
            <button
              class="btn btn-primary w-25 ms-3"
              (click)="getMongoDBResponse(mno)"
            >
              start
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    class="row action mt- 3 border border-2 rounded bg-info bg-opacity-10 border border-info"
  >
    <div class="text-dark" *ngIf="!getIDsObj; else loadIframe">
      Waiting for a call…
    </div>

    <!-- for testing css  -->
    <!-- 
    <div class="text-dark" *ngIf="getIDsObj; else loadIframe">
      Waiting for a call…
    </div> -->

    <ng-template #loadIframe class="d-flex">
      <div class="col-5">
        <div class="card shadow-lg">
          <div class="card-body">
            <div class="authentication">
              <div
                class="alert notice notice-success text-wrap d-flex"
                [style]="{ 'border-color': alertBoxColor }"
                role="alert"
              >
                <div class="text-wrap" style="text-align: left; height: 25px">
                  {{ sessionBootstrapData?.firstName }}
                  {{ sessionBootstrapData?.lastName }}
                </div>

                <div
                  style="position: absolute; right: 15px"
                  *ngIf="sessionBootstrapIsEnrolled"
                >
                  <svg
                    width="25"
                    height="24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="text-orange-600"
                    [ngStyle]="{ color: RequestIconColor }"
                  >
                    <!-- auth 089000 -->
                    <!-- enrolled fc6a03 -->
                    <!-- unenrolled  #FF0000 -->
                    <!-- [style.color]="sessionBootstrapIsEnrolled ? 'orange' : 'red'" -->

                    <path
                      d="M2.083 2 12.5 5.265 22.917 2v16.735L12.5 22 2.083 18.735V2Z"
                      fill="currentColor"
                    ></path>
                    <path
                      d="m7.185 13.122 3.402 2.347 7.015-6.735"
                      stroke="#fff"
                      stroke-width="2"
                    ></path>
                  </svg>

                  <!-- *ngIf="sessionBootstrapIsEnrolled" -->

                  <span class="ms-2" style="text-align: right">
                    <strong [ngStyle]="{ color: RequestLabelColor }">{{
                      RequestLabelName
                    }}</strong>
                  </span>

                  <!-- <span class="ms-2" style="text-align: right; color: #ff0000">
                    <strong>Unenrolled</strong>
                  </span> -->

                  <!-- <span class="ms-2" style="text-align: right; color: #089000">
                    <strong>Authenticated</strong></span > -->
                </div>
              </div>

              <div class="d-flex">
                <button
                  class="btn w-75 text-wrap fw-bold me-2"
                  style="background-color: #00324e; color: #fff"
                  (click)="sendFacialEnrollmentRequest()"
                >
                  Facial Enrollment Request
                </button>
                <button
                  class="btn w-75 text-wrap fw-bold"
                  style="background-color: #00324e; color: #fff"
                  (click)="sendFacialAuthRequest()"
                >
                  Facial Authentication Request
                </button>
              </div>
              <div class="d-flex mt-2">
                <button
                  class="btn w-100 text-wrap fw-bold me-2"
                  style="background-color: #00324e; color: #fff"
                  (click)="sendBiometricEnrollRequest()"
                >
                  Enroll Biometrics
                </button>

                <button
                  class="btn w-100 text-wrap fw-bold"
                  style="background-color: #00324e; color: #fff"
                  (click)="sendBiometricAuthenticatoinRequest()"
                >
                  Authenticate Biometrics
                </button>
              </div>

              <div class="d-flex mt-2">
                <button
                  class="btn w-100 text-wrap fw-bold me-2"
                  style="background-color: #00324e; color: #fff"
                  (click)="sdkEnroll()"
                >
                  Mobile App Enroll
                </button>

                <button
                  class="btn w-100 text-wrap fw-bold"
                  style="background-color: #00324e; color: #fff"
                  (click)="sdkAuthentication()"
                >
                  Mobile App Authenticate
                </button>
              </div>

              <!-- <div class="d-flex justify-content-center mt-4 SDK">
                <div class="sdk-enroll">
                  <button
                    class="btn fw-bold"
                    style="background-color: #00324e; color: #fff"
                    (click)="sdkEnroll()"
                  >
                    SDK - Enroll
                  </button>
                </div>
                <div class="sdk-auth">
                  <button
                    class="btn fw-bold ms-3"
                    style="background-color: #00324e; color: #fff"
                    (click)="sdkAuthentication()"
                  >
                    SDK - Authenticate
                  </button>
                </div>
              </div> -->
            </div>

            <div class="input-group mb-3 mt-3">
              <span class="input-group-text" id="basic-addon1">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-search"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                  />
                </svg>
              </span>
              <input
                type="text"
                class="form-control"
                placeholder="Search"
                aria-label="Username"
                aria-describedby="basic-addon1"
              />
            </div>

            <!-- other authentication options -->

            <div class="accordion mt-3" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                  <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#panelsStayOpen-collapseOne"
                    aria-expanded="true"
                    aria-controls="panelsStayOpen-collapseOne"
                  >
                    <span class="fw-bold text-start text-dark">
                      e-Signature
                    </span>
                  </button>
                </h2>
                <div
                  id="panelsStayOpen-collapseOne"
                  class="accordion-collapse collapse show"
                  aria-labelledby="panelsStayOpen-headingOne"
                >
                  <div class="accordion-body">
                    <div class="text-start text-dark">
                      <div class="row mt-2">
                        <div class="col-11">
                          Digital Signature Request - Fee Waiver
                        </div>
                        <div class="col-1">
                          <svg
                            style="width: 16px; color: #78553c"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            (click)="sendSignatureRequest()"
                          >
                            <path
                              d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 
                          416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 
                          427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 
                          480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 
                          202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 
                          316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 
                          23.9-5.5 34 1.4z"
                            />
                          </svg>
                        </div>
                      </div>

                      <div class="row mt-2">
                        <div class="col-11">PB_CreditCardPayment</div>
                        <div class="col-1">
                          <svg
                            style="width: 16px; color: #78553c"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            (click)="openVerticallyCentered(content)"
                          >
                            <path
                              d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 
                          416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 
                          427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 
                          480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 
                          202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 
                          316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 
                          23.9-5.5 34 1.4z"
                            />
                          </svg>
                        </div>
                      </div>

                      <div class="row mt-2">
                        <div class="col-11">Outbound Notification</div>
                        <div class="col-1">
                          <svg
                            style="width: 16px; color: #78553c"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            (click)="
                              openOutboundNotificationModal(
                                outboundNotification
                              )
                            "
                          >
                            <path
                              d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 
                          416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 
                          427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 
                          480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 
                          202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 
                          316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 
                          23.9-5.5 34 1.4z"
                            />
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- open modal code  -->
      <ng-template #content let-modal>
        <div class="modal-header">
          <h4 class="modal-title">PB_CreditCardPayment</h4>
          <!-- <button
            type="button"
            class="btn-close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          ></button> -->
        </div>
        <div class="modal-body">
          <div class="Payment-details">
            <div class="desc fw-bold">
              <label class="form-label">Description</label>
              <input
                type="text"
                class="form-control"
                placeholder="Description"
                #desc
              />
            </div>

            <div class="desc mt-4">
              <label class="form-label fw-bold">Cost</label>
              <div class="input-group mb-3">
                <span class="input-group-text">$</span>
                <input type="text" class="form-control" #amount />
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer justify-content-start">
          <div class="d-flex action-button">
            <button
              type="button"
              class="btn btn-primary me-3"
              (click)="
                sendPaymentRequest(desc, amount); modal.close('Close click')
              "
            >
              Send Request
            </button>

            <button
              type="button"
              class="btn btn-secondary"
              (click)="modal.close('Close click')"
            >
              Cancel
            </button>
          </div>
        </div>
      </ng-template>
      <!-- modal code  end -->

      <!-- Send outbound notification modal open -->

      <ng-template #outboundNotification let-modal>
        <div class="modal-header">
          <h4 class="modal-title">Outbound Notification</h4>
          <!-- <button
            type="button"
            class="btn-close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          ></button> -->
        </div>
        <div class="modal-body">
          <div class="Payment-details">
            <div class="desc fw-bold">
              <label class="form-label">Reason</label>
              <input
                type="text"
                class="form-control"
                placeholder="Description"
                #reason
              />
            </div>

            <!-- <div class="desc mt-4">
              <label class="form-label fw-bold">Cost</label>
              <div class="input-group mb-3">
                <span class="input-group-text">$</span>
                <input type="text" class="form-control" #amount />
              </div>
            </div> -->
          </div>
        </div>
        <div class="modal-footer justify-content-start">
          <div class="d-flex action-button">
            <button
              type="button"
              class="btn btn-primary me-3"
              (click)="
                sendOutboundNotificatoin(reason); modal.close('Close click')
              "
            >
              Send Request
            </button>

            <button
              type="button"
              class="btn btn-secondary"
              (click)="modal.close('Close click')"
            >
              Cancel
            </button>
          </div>
        </div>
      </ng-template>
      <!-- Send outbound notification modal close -->

      <div class="col-7 notifications" *ngIf="sendAuthRequestFlag">
        <!--*ngIf="sendAuthRequestFlag"  -->

        <div class="card shadow-lg">
          <div class="card-body">
            <div class="accordion mt-3" id="accordionPanelsStayOpenExample2">
              <div class="accordion-item">
                <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                  <button
                    class="accordion-button position-relative"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#panelsStayOpen-collapseOne2"
                    aria-expanded="true"
                    aria-controls="panelsStayOpen-collapseOne"
                  >
                    <span
                      style="
                        margin-left: 80px;

                        width: 20%;
                      "
                      [ngStyle]="{
                        'background-color':
                          processLabelBGColor == null
                            ? 'gray'
                            : processLabelBGColor
                      }"
                      class="fw-bold p-2 text-wrap position-absolute top-0 translate-middle text-dark badge rounded-pill"
                    >
                      <!-- #ffd580;  req -->
                      <!-- b0e0e6 started -->
                      <!-- completed 90ee90 -->

                      <svg
                        width="15"
                        aria-hidden="true"
                        focusable="false"
                        data-prefix="far"
                        data-icon="paper-plane"
                        class="svg-inline--fa fa-paper-plane _Icon_1n7rb_11"
                        role="img"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        [ngStyle]="{ color: processIconColor }"
                      >
                        <!-- color="#fc6a03"  req -->
                        <!-- stated  00BFFF-->
                        <!-- completed 089000 -->
                        <path
                          fill="currentColor"
                          d="M501.6 4.186c-7.594-5.156-17.41-5.594-25.44-1.063L12.12 267.1C4.184 271.7-.5037 280.3 .0431 289.4c.5469 9.125 6.234 17.16 14.66 20.69l153.3 64.38v113.5c0 8.781 4.797 16.84 12.5 21.06C184.1 511 188 512 191.1 512c4.516 0 9.038-1.281 12.99-3.812l111.2-71.46l98.56 41.4c2.984 1.25 6.141 1.875 9.297 1.875c4.078 0 8.141-1.031 11.78-3.094c6.453-3.625 10.88-10.06 11.95-17.38l64-432C513.1 18.44 509.1 9.373 501.6 4.186zM369.3 119.2l-187.1 208.9L78.23 284.7L369.3 119.2zM215.1 444v-49.36l46.45 19.51L215.1 444zM404.8 421.9l-176.6-74.19l224.6-249.5L404.8 421.9z"
                        ></path>
                      </svg>

                      <!-- <span class="ms-2" style="color: #fc6a03">Requested</span> -->
                      <!-- <span class="ms-2" style="color: #00bfff">Started</span> -->
                      <span
                        class="ms-2"
                        [ngStyle]="{ color: processLabelColor }"
                        >{{ processLabelName }}</span
                      >
                    </span>
                    <span class="fw-bold text-start text-dark mt-1">
                      {{ authRequestedData?.pipeline.title }}
                    </span>
                  </button>
                </h2>

                <div
                  id="panelsStayOpen-collapseOne2"
                  class="accordion-collapse collapse show"
                  aria-labelledby="panelsStayOpen-headingOne2"
                >
                  <div class="accordion-body">
                    <div class="row">
                      <div class="col-9">
                        <div class="d-flex">
                          <svg
                            aria-hidden="true"
                            focusable="false"
                            data-prefix="far"
                            data-icon="circle-info"
                            class="svg-inline--fa fa-circle-info text-gray-600 text-start"
                            role="img"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            style="width: 16px"
                          >
                            <path
                              fill="currentColor"
                              d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 464c-114.7 0-208-93.31-208-208S141.3 48 256 48s208 93.31 208 208S370.7 464 256 464zM296 336h-16V248C280 234.8 269.3 224 256 224H224C210.8 224 200 234.8 200 248S210.8 272 224 272h8v64h-16C202.8 336 192 346.8 192 360S202.8 384 216 384h80c13.25 0 24-10.75 24-24S309.3 336 296 336zM256 192c17.67 0 32-14.33 32-32c0-17.67-14.33-32-32-32S224 142.3 224 160C224 177.7 238.3 192 256 192z"
                            ></path>
                          </svg>
                          <div class="ms-1 text-secondary fw-bold text-start">
                            Sent via SMS to
                            {{ authRequestedData?.delivery.phoneNumber }}
                          </div>
                        </div>
                      </div>
                      <div class="col-3">
                        <div class="text-end">just now</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- testing for color -->
            <!-- <div class="test" style="margin-top: 30px; position: fixed">
              <button
                class="btn btn-danger me-3"
                (click)="
                  alertBoxColor = '#fc6a03';
                  RequestIconColor = '#fc6a03';
                  processLabelBGColor = '#ffd580';
                  processLabelName = 'Requested';
                  processIconColor = '#fc6a03';
                  processLabelColor = '#fc6a03';
                  RequestLabelName = 'Enrolled';
                  RequestLabelColor = '#fc6a03'
                "
              >
                Requested
              </button>
              <button
                class="btn btn-primary me-3"
                (click)="
                  alertBoxColor = '#fc6a03';
                  RequestIconColor = '#fc6a03';
                  processLabelBGColor = '#b0e0e6';
                  processLabelName = 'Started';
                  processIconColor = '#00bfff';
                  processLabelColor = '#00bfff';
                  RequestLabelName = 'Enrolled';
                  RequestLabelColor = '#fc6a03'
                "
              >
                Started
              </button>
              <button
                class="btn btn-success"
                (click)="
                  alertBoxColor = '#089000';
                  RequestIconColor = '#089000';
                  processLabelBGColor = '#90ee90';
                  processLabelName = 'Completed';
                  processIconColor = '#089000';
                  processLabelColor = '#089000';
                  RequestLabelName = 'Authenticated';
                  RequestLabelColor = '#089000'
                "
              >
                Completed
              </button>
            </div> -->
            <!--end testing for color -->
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
